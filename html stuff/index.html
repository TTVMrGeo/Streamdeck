<!-- web/index.html -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Streamdeck Settings</title>
        <link rel="stylesheet" href="style.css">
        <script type="text/javascript" src="/eel.js"></script>
    </head>

    <body>
        <button onclick="callPython()">Check for updates</button>
        <p id="output"></p>
        
        <div class="menu-container">
            <!-- Move the input outside the label -->
            <input type="checkbox" id="burger">
            <label class="burger" for="burger">
                <span></span>
                <span></span>
                <span></span>
            </label>
            
            <!-- Slide-out Menu -->
            <div class="slide-out-menu">
                <!-- Theme Toggle -->
                 <h1 class="settings_title">
                    Toggle Dark Mode
                </h1>
                <div class="theme">
                    <label for="theme" class="theme__toggle-wrap">
                        <input id="theme" class="theme__toggle" type="checkbox" role="switch" name="theme" value="dark">
                        <span class="theme__fill"></span>
                        <span class="theme__icon">
                            <span class="theme__icon-part"></span>
                            <!-- ... keep all icon parts ... -->
                        </span>
                    </label>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            async function callPython() {
                let result = await eel.update()();
                document.getElementById('output').innerText = result;
            }
            // Theme toggle functionality remains the same
            const themeToggle = document.getElementById('theme');
            const body = document.body;

            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme') || 
                            (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');

            // Apply saved theme
            if (savedTheme === 'light') {
                body.classList.add('light-theme');
                themeToggle.checked = false;
            }

            // Handle theme toggle
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    body.classList.remove('light-theme');
                    localStorage.setItem('theme', 'dark');
                } else {
                    body.classList.add('light-theme');
                    localStorage.setItem('theme', 'light');
                }
            });

            // Close menu when clicking outside
            document.addEventListener('click', function(event) {
                const menuContainer = document.querySelector('.menu-container');
                const burger = document.getElementById('burger');
                
                if (!menuContainer.contains(event.target) && burger.checked) {
                    burger.checked = false;
                }
            });
        </script>
    </body>
</html>